<?php
use Magento\Framework\Escaper;
use Magento\LayeredNavigation\ViewModel\Layer\Filter;

/** @var \Magento\LayeredNavigation\Block\Navigation\FilterRenderer $block */
/** @var Escaper $escaper */
/** @var Filter $viewModel */

$viewModel = $block->getData('product_layer_view_model');
$mageVersion = $block->getVersion();
$filterCounts = $block->getData('filter_counts');
$filter = $block->getData('filter'); 
echo "<pre>";
var_dump($filterCounts);
var_dump($filter);
echo "</pre>";
// Initialize locale formatter if needed (Magento 2.4.5+)
$localeFormatter = null;
if (version_compare($mageVersion, "2.4.5", '>')) {
    $localeFormatter = $block->getLocaleFormatter();
}
?>

<ol class="items">
    <?php foreach ($filterItems as $filterItem): ?>
        <?php

        echo "<script>console.log('Filter Value:', " . $filterItem->getValue() . ");</script>";

        $filterCount = 0;
        if ($filter && isset($filterCounts[$block->escapeHtml($filter->getRequestVar())][$filterItem->getValue()])) { 
            $filterCount = $filterCounts[$block->escapeHtml($filter->getRequestVar())][$filterItem->getValue()];
        }
        ?>

        <li class="item">
            <?php if ($filterCount > 0): ?>
                <a href="<?= $escaper->escapeUrl($filterItem->getUrl()) ?>" rel="nofollow">
                    <?= $escaper->escapeHtml($filterItem->getLabel()) ?>
                    <?php if ($viewModel->shouldDisplayProductCountOnLayer()): ?>
                        <span class="count">
                            <?php if ($localeFormatter): ?>
                                <?= $escaper->escapeHtml($localeFormatter->formatNumber($filterCount)) ?>
                            <?php else: ?>
                                <?= $escaper->escapeHtml($filterCount) ?>
                            <?php endif; ?>
                            <span class="filter-count-label">
                                <?= $escaper->escapeHtml(__($filterCount == 1 ? 'item' : 'items')) ?>
                            </span>
                        </span>
                    <?php endif; ?>
                </a>
            <?php else: ?>
                <span class="item-label"><?= $escaper->escapeHtml($filterItem->getLabel()) ?></span> 
                <?php if ($viewModel->shouldDisplayProductCountOnLayer()): ?>
                    <span class="count">
                        <?php if ($localeFormatter): ?>
                            <?= $escaper->escapeHtml($localeFormatter->formatNumber($filterCount)) ?>
                        <?php else: ?>
                            <?= $escaper->escapeHtml($filterCount) ?>
                        <?php endif; ?>
                        <span class="filter-count-label">
                            <?= $escaper->escapeHtml(__('items')) ?>
                        </span>
                    </span>
                <?php endif; ?>
            <?php endif; ?>
        </li>
    <?php endforeach; ?>
</ol>